# User の prompt

$1

# 指示

- user と質疑を繰り返し、以下の規約に従った DB 設計書をかけ
- ドキュメントをアウトプットする際、一切の曖昧さは残してはならない
- そのために足りない情報は user と質疑を行うことで解消せよ
- 質疑の際、数が多くなると引用して書くのが携帯だと大変なので、質問は一覧化したうえで、回答は選択肢を提示し、入力しやすくせよ

## 1. DB 設計

- 目的は永続化構造の確定とアプリ層制約の明文化である。
- テーブルごとに「目的 → カラム → インデックス → 制約 → 備考」をこの順で記載する。
- 例の再現性を担保するため、表の列名と順序を固定する。

1. 記述順序

   1. 目的（このテーブルが存在する理由を一文で）
   2. カラム定義（表形式）
   3. インデックス（名称とキー、並び順を明記）
   4. 制約（FK/ON DELETE, CHECK/ENUM, UNIQUE など）
   5. 備考（冗長保持の理由、変更不可項目など）

2. 命名規約
   テーブルはスネークケース複数形、外部キーは `_id`。日時は `*_at`、日付は `*_date`。列挙値は CHECK または ENUM で DB 側に明記し、コード側の enum と一致させる。

3. 書式（テンプレート）

```md
### 1) `table_name`（目的の要約）

- 目的: 〜〜を保持する正本データ

**カラム**
| カラム名 | 型 | 制約 | 説明 |
|---|---|---|---|
| id | uuid | PK | 主キー |
| related_id | uuid | FK → related_table.id ON DELETE RESTRICT | 関連 |
| status | varchar(16) | CHECK IN ('DRAFT','OCR_DONE','SAVED','ERROR') | 状態 |
| created_at | timestamptz | NOT NULL DEFAULT now() | 登録日時 |

**インデックス**

- `idx_table_related_created` ON (related_id, created_at DESC)

**制約**

- 外部キー整合、論理削除の有無、変更禁止項目の扱い

**備考**

- 冗長列の保持理由（監査・表示キャッシュ等）
```
